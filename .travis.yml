language: python
python:
  - "2.7"
  
before_install:
   # add for profile
  - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
  - sudo apt-get update -qq

# command to install dependencies
# some are only used for travis/coveralls so we are installing them here only
install:
  - ./test/setup_test.sh
  # add for profile
  - sudo apt-get install -qq g++-4.8
  - export CXX="g++-4.8"
  - pip install nose-cprof
  - pip install properform

# command to run tests
# notice: the nose-cov is used because it is compatible with --processes, but produce a .coverage by process
# so we must combine them in the end
script:
  - cd test
  - nosetests -xv --process-restartworker --processes=1 --process-timeout=999999999  --with-cov --cov=shinken --with-cprofile --cprofile-stats-erase --cprofile-stats-file=profile_alignak_b16ebff4bb_0
  - python -m properform Push 47.88.50.110:15554 asdf_alignak_b16ebff4bb_0 ./profile_alignak_b16ebff4bb_0
  - coverage combine
  - cd .. && pep8 --max-line-length=100 --ignore=E303,E302,E301,E241 --exclude='*.pyc' shinken/*
# specific call to launch coverage data into coveralls.io
after_success:
  coveralls
 #2017-08-14 08:49:48 modified at 0